(function(){const T=document.createElement("link").relList;if(T&&T.supports&&T.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))M(u);new MutationObserver(u=>{for(const g of u)if(g.type==="childList")for(const b of g.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&M(b)}).observe(document,{childList:!0,subtree:!0});function k(u){const g={};return u.integrity&&(g.integrity=u.integrity),u.referrerPolicy&&(g.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?g.credentials="include":u.crossOrigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function M(u){if(u.ep)return;u.ep=!0;const g=k(u);fetch(u.href,g)}})();function le(){sap.ui.require(["sap/m/App","sap/m/Page","sap/m/Select","sap/m/Label","sap/m/DatePicker","sap/m/VBox","sap/m/HBox","sap/ui/unified/Calendar","sap/ui/unified/CalendarLegend","sap/ui/unified/CalendarLegendItem","sap/ui/unified/DateTypeRange","sap/ui/model/json/JSONModel","sap/ui/core/date/UI5Date","sap/ui/core/CustomData","sap/m/MessageToast","sap/m/Button","sap/m/Image","sap/m/Title"],function(R,T,k,M,u,g,b,N,P,de,K,q,z,F,I,U,V,H){const m=new q({entryMethod:null,selectedDate:null,selectedCalendar:"Reperes",specialDates:[],legendColors:[{text:"Dernières règles",color:"#4B0082",type:"Type01"},{text:"1 mois",color:"#FF3B3F",type:"Type02"},{text:"2 mois",color:"#FF9A00",type:"Type03"},{text:"3 mois",color:"#FFDA00",type:"Type04"},{text:"4 mois",color:"#6A0DAD",type:"Type05"},{text:"5 mois",color:"#FF69B4",type:"Type06"},{text:"6 mois",color:"#00FA9A",type:"Type07"},{text:"7 mois",color:"#111000",type:"Type08"},{text:"8 mois",color:"#00BFFF",type:"Type09"},{text:"9 mois",color:"#FFD700",type:"Type10"},{text:"DPA",color:"#2F4F4F",type:"Type20"}],legendColorsEchos:[{text:"Echo T1 datation",color:"#00FA9A",type:"Type11"},{text:"Echo T2 morphologie",color:"#00BFFF",type:"Type12"},{text:"Echo T3 croissance",color:"#FF69B4",type:"Type13"}],legendColorsSeuils:[{text:"Dépistage du diabète gestationnel",color:"#FF9A00",type:"Type14"},{text:"Grande prématurité",color:"#6A0DAD",type:"Type15"},{text:"Prématurité modérée",color:"#111000",type:"Type16"},{text:"Prématurité tardive",color:"#00BFFF",type:"Type17"},{text:"A terme",color:"#00FA9A",type:"Type18"}]}),D=new H({id:"calendarTitle",level:"H1"});D.setText("Mon calendrier de grossesse");function A(e){if(!e)return;const s=m.getProperty("/entryMethod"),a=[],o=m.getProperty("/legendColors")||[];let i,n=null,t="#E0E0E0";switch(s){case"regles":i=moment(e,"YYYY-MM-DD").toDate(),a.push({startDate:i,endDate:i,color:"#4B0082",type:"Type01",weekLabel:"Date des dernières règles"});break;case"conception":i=moment(e,"YYYY-MM-DD").subtract(14,"days").toDate(),a.push({startDate:moment(e,"YYYY-MM-DD").toDate(),endDate:moment(e,"YYYY-MM-DD").toDate(),color:"#4B0082",type:"Type01",weekLabel:"Date de conception estimée"});break;case"dpa":i=moment(e,"YYYY-MM-DD").subtract(280,"days").toDate(),a.push({startDate:moment(e,"YYYY-MM-DD").subtract(266,"days").toDate(),endDate:moment(e,"YYYY-MM-DD").subtract(266,"days").toDate(),color:"#4B0082",type:"Type01",weekLabel:"Date de conception estimée"});break;default:i=moment(e,"YYYY-MM-DD").toDate(),a.push({startDate:i,endDate:i,color:"#4B0082",type:"Type01",weekLabel:"Date des dernières règles"})}a.push({startDate:moment(i).add(280,"days").toDate(),endDate:moment(i).add(280,"days").toDate(),color:"#2F4F4F",type:"Type20",weekLabel:"Date prévue d'accouchement (DPA)"});let c=0,p=1;for(let h=0;h<41;h++){const l=h,r=moment(i).add(l,"weeks");if(l<2){n="Type12";const d=o.find(y=>y.type===n);t=d?d.color:"#E0E0E0",a.push({startDate:r.toDate(),endDate:moment(r).add(6,"days").toDate(),color:t,type:n,weekLabel:`${l} SA`,monthLabel:"Mois "+c,trimesterLabel:"Trimestre "+p})}else if(l>1&&l<5){c=1,n="Type02";const d=o.find(y=>y.type===n);t=d?d.color:"#E0E0E0",a.push({startDate:r.toDate(),endDate:moment(r).add(6,"days").toDate(),color:t,type:n,weekLabel:`${l} SA`,monthLabel:"Mois "+c,trimesterLabel:"Trimestre "+p})}else if(l>4&&l<9){c=2,n="Type03";const d=o.find(y=>y.type===n);t=d?d.color:"#E0E0E0",a.push({startDate:r.toDate(),endDate:moment(r).add(6,"days").toDate(),color:t,type:n,weekLabel:`${l} SA`,monthLabel:"Mois "+c,trimesterLabel:"Trimestre "+p})}else if(l>8&&l<14){c=3,n="Type04";const d=o.find(y=>y.type===n);t=d?d.color:"#E0E0E0",a.push({startDate:r.toDate(),endDate:moment(r).add(6,"days").toDate(),color:t,type:n,weekLabel:`${l} SA`,monthLabel:"Mois "+c,trimesterLabel:"Trimestre "+p})}else if(l>13&&l<19){c=4,p=2,n="Type05";const d=o.find(y=>y.type===n);t=d?d.color:"#E0E0E0",a.push({startDate:r.toDate(),endDate:moment(r).add(6,"days").toDate(),color:t,type:n,weekLabel:`${l} SA`,monthLabel:"Mois "+c,trimesterLabel:"Trimestre "+p})}else if(l>18&&l<23){c=5,p=2,n="Type06";const d=o.find(y=>y.type===n);t=d?d.color:"#E0E0E0",a.push({startDate:r.toDate(),endDate:moment(r).add(6,"days").toDate(),color:t,type:n,weekLabel:`${l} SA`,monthLabel:"Mois "+c,trimesterLabel:"Trimestre "+p})}else if(l>22&&l<28){c=6,p=2,n="Type07";const d=o.find(y=>y.type===n);t=d?d.color:"#E0E0E0",a.push({startDate:r.toDate(),endDate:moment(r).add(6,"days").toDate(),color:t,type:n,weekLabel:`${l} SA`,monthLabel:"Mois "+c,trimesterLabel:"Trimestre "+p})}else if(l>27&&l<32){c=7,p=3,n="Type08";const d=o.find(y=>y.type===n);t=d?d.color:"#E0E0E0",a.push({startDate:r.toDate(),endDate:moment(r).add(6,"days").toDate(),color:t,type:n,weekLabel:`${l} SA`,monthLabel:"Mois "+c,trimesterLabel:"Trimestre "+p})}else if(l>31&&l<36){c=8,p=3,n="Type09";const d=o.find(y=>y.type===n);t=d?d.color:"#E0E0E0",a.push({startDate:r.toDate(),endDate:moment(r).add(6,"days").toDate(),color:t,type:n,weekLabel:`${l} SA`,monthLabel:"Mois "+c,trimesterLabel:"Trimestre "+p})}else if(l>35&&l<40){c=9,p=3,n="Type10";const d=o.find(y=>y.type===n);t=d?d.color:"#E0E0E0",a.push({startDate:r.toDate(),endDate:moment(r).add(6,"days").toDate(),color:t,type:n,weekLabel:`${l} SA`,monthLabel:"Mois "+c,trimesterLabel:"Trimestre "+p})}}m.setProperty("/specialDates",a),f.setMinDate(i),f.setInitialFocusedDate(i),B.getItems().forEach(h=>{h.getKey()!=="Reperes"&&h.setEnabled(!0)})}function G(e){let s,a,o,i;if(e.length>0){const t=e[0];t.weekLabel==="Date des dernières règles"?s=moment(t.startDate):t.weekLabel==="Date de conception estimée"&&(s=moment(t.startDate).subtract(14,"days"))}e=e.filter(t=>t.type==="Type01"||t.type==="Type20"),m.setProperty("/specialDates",e);const n=m.getProperty("/legendColorsEchos")||[];o="Type11",a=n.find(t=>t.type===o),i=a?a.color:"#E0E0E0",e.push({startDate:moment(s).add(77,"days").toDate(),endDate:moment(s).add(97,"days").toDate(),color:i,type:o,weekLabel:"Echos T1 datation"}),o="Type12",a=n.find(t=>t.type===o),i=a?a.color:"#E0E0E0",e.push({startDate:moment(s).add(140,"days").toDate(),endDate:moment(s).add(175,"days").toDate(),color:i,type:o,weekLabel:"Echos T2 morphologie"}),o="Type13",a=n.find(t=>t.type===o),i=a?a.color:"#E0E0E0",e.push({startDate:moment(s).add(210,"days").toDate(),endDate:moment(s).add(245,"days").toDate(),color:i,type:o,weekLabel:"Echos T3 croissance"}),m.setProperty("/specialDates",e)}function Q(e){let s,a,o,i;if(e.length>0){const t=e[0];t.weekLabel==="Date des dernières règles"?s=moment(t.startDate):t.weekLabel==="Date de conception estimée"&&(s=moment(t.startDate).subtract(14,"days"))}e=e.filter(t=>t.type==="Type01"||t.type==="Type20"),m.setProperty("/specialDates",e);const n=m.getProperty("/legendColorsSeuils")||[];o="Type14",a=n.find(t=>t.type===o),i=a?a.color:"#E0E0E0",e.push({startDate:moment(s).add(168,"days").toDate(),endDate:moment(s).add(196,"days").toDate(),color:i,type:o,weekLabel:"Dépistage du diabète gestationnel"}),o="Type15",a=n.find(t=>t.type===o),i=a?a.color:"#E0E0E0",e.push({startDate:moment(s).add(196,"days").toDate(),endDate:moment(s).add(223,"days").toDate(),color:i,type:o,weekLabel:"Grande prématurité"}),o="Type16",a=n.find(t=>t.type===o),i=a?a.color:"#E0E0E0",e.push({startDate:moment(s).add(224,"days").toDate(),endDate:moment(s).add(244,"days").toDate(),color:i,type:o,weekLabel:"Prématurité modérée"}),o="Type17",a=n.find(t=>t.type===o),i=a?a.color:"#E0E0E0",e.push({startDate:moment(s).add(245,"days").toDate(),endDate:moment(s).add(258,"days").toDate(),color:i,type:o,weekLabel:"Prématurité tardive"}),o="Type18",a=n.find(t=>t.type===o),i=a?a.color:"#E0E0E0",e.push({startDate:moment(s).add(259,"days").toDate(),endDate:moment(s).add(280,"days").toDate(),color:i,type:o,weekLabel:"A terme"}),m.setProperty("/specialDates",e)}function _(){const e=f.getSelectedDates()[0].getStartDate(),s=moment(e).startOf("day"),a=m.getProperty("/selectedCalendar");if(D){debugger;switch(a){case"Reperes":D.setText("Mon calendrier de grossesse");break;case"Echos":D.setText("Mon calendrier des échographies");break;case"Seuils":D.setText("Mon calendrier des seuils");break;default:D.setText("Mon calendrier de grossesse")}}const o=f.getSpecialDates();let i="Aucune légende",n="",t="",c=0;const p=m.getProperty("/entryMethod"),h=o.find(r=>moment(r.mProperties.startDate).isSame(s,"day")&&r.mProperties.type==="Type01"),l=o.find(r=>moment(r.mProperties.startDate).isSame(s,"day")&&r.mProperties.type==="Type20");if(h){let r="";switch(p){case"regles":r="Date des dernières règles";break;case"conception":r="Date estimée de conception";break;case"dpa":r="Date estimée de conception";break;default:r="Date des dernières règles"}I.show(r,{duration:5e3,width:"100%",my:"CenterBottom",at:"CenterCenter",of:window,offset:"0 0",collision:"fit fit",onClose:null,autoClose:!0,animationTimingFunction:"ease",animationDuration:1e3,closeOnBrowserNavigation:!0});return}if(l){I.show("Date prévue d'accouchement (DPA)",{duration:5e3,width:"100%",my:"CenterBottom",at:"CenterCenter",of:window,offset:"0 0",collision:"fit fit",onClose:null,autoClose:!0,animationTimingFunction:"ease",animationDuration:1e3,closeOnBrowserNavigation:!0});return}for(let r=0;r<o.length;r++){const d=moment(o[r].mProperties.startDate).startOf("day"),y=o[r].mProperties.endDate?moment(o[r].mProperties.endDate).startOf("day"):d;if(s.isSameOrAfter(d)&&s.isSameOrBefore(y)){o[r].mProperties.type,o[r].getCustomData().forEach(j=>{const Y=j.getKey(),O=j.getValue();Y==="weekLabel"?i=O:Y==="monthLabel"?n=O:Y==="trimesterLabel"&&(t=O)}),c=s.diff(d,"days");break}}if(i&&i!=="Aucune légende"){c>0&&a==="Reperes"&&(i+=` + ${c}`);const r=[i,n!=="0 mois de grosssesse"?n:null,t].filter(Boolean).join(`
`);I.show(r,{duration:5e3,width:"100%",my:"CenterBottom",at:"CenterCenter",of:window,offset:"0 0",collision:"fit fit",onClose:null,autoClose:!0,animationTimingFunction:"ease",animationDuration:1e3,closeOnBrowserNavigation:!0})}}function J(e){const s=m.getProperty("/specialDates");if(e==="Reperes")f.setLegend(w),w.setVisible(!0),L.setVisible(!1),C.setVisible(!1),x.setEnabled(!0),S.setEnabled(!0),A(m.getProperty("/selectedDate"));else if(e==="Echos"){if(s.length===0)return;f.setLegend(L),L.setVisible(!0),w.setVisible(!1),C.setVisible(!1),x.setEnabled(!1),S.setEnabled(!1),G(s)}else if(e==="Seuils"){if(s.length===0)return;f.setLegend(C),C.setVisible(!0),w.setVisible(!1),L.setVisible(!1),x.setEnabled(!1),S.setEnabled(!1),Q(s)}}async function X(e){const s=e.getDomRef();if(!s)return;s.style.overflow="visible";const a=await domtoimage.toPng(s,{quality:1,bgcolor:"#FFFFFF",width:s.clientWidth,height:s.clientHeight,style:{transform:"none",opacity:1,visibility:"visible"}}),o=new jsPDF({orientation:"landscape",unit:"mm",format:"a4"}),i=o.internal.pageSize.getWidth(),n=o.internal.pageSize.getHeight(),t=230,c=.264583,p=s.getBoundingClientRect();let h=t,l=p.height*c*(t/(p.width*c));const r=(i-h)/2,d=(n-l)/2;o.addImage(a,"PNG",r,d,h,l),o.save("calendrier.pdf")}const x=new k({width:"250px",selectedKey:null,change:function(e){const s=e.getParameter("selectedItem").getKey();m.setProperty("/entryMethod",s);var a=m.getProperty("/selectedDate");a&&A(a);const o=s==="regles"?"Dernières règles":"Conception estimée",i=w.getItems();i.length>0&&i[0].setText(o)},items:[new sap.ui.core.Item({key:"regles",text:"Dernières règles"}),new sap.ui.core.Item({key:"conception",text:"Conception estimée"}),new sap.ui.core.Item({key:"dpa",text:"DPA"})]}),S=new u({width:"200px",placeholder:"Sélectionnez une date",value:"{/selectedDate}",displayFormat:"dd/MM/yyyy",valueFormat:"yyyy-MM-dd",change:function(e){const s=e.getSource().getValue();m.setProperty("/selectedDate",s),A(s),w.setVisible(!0)}}),B=new sap.m.SegmentedButton({selectedKey:"Reperes",width:"300px",items:[new sap.m.SegmentedButtonItem({key:"Reperes",text:"Calendrier",tooltip:"Calendrier des semaines d'aménorrhée"}),new sap.m.SegmentedButtonItem({key:"Echos",text:"Echos",tooltip:"Retrouvez les grandes étapes d'imagerie de la grossesse",enabled:!1}),new sap.m.SegmentedButtonItem({key:"Seuils",text:"Seuils",tooltip:"Suivez les périodes sensibles de la grossesse",enabled:!1})],selectionChange:function(e){const s=e.getParameter("item").getKey();if(m.setProperty("/selectedCalendar",s),D)switch(s){case"Reperes":D.setText("Mon calendrier de grossesse");break;case"Echos":D.setText("Mon calendrier des échographies");break;case"Seuils":D.setText("Mon calendrier des seuils");break;default:D.setText("Mon calendrier de grossesse")}var a=m.getProperty("/selectedCalendar");a&&J(a)}});B.addStyleClass("CassylSegmentedButton"),new sap.m.Switch({state:!1,customTextOn:"RDV",customTextOff:"SA",enabled:!1,change:function(e){}});const Z=m.getProperty("/legendColors"),w=new P({visible:!1,standardItems:"Today",columnWidth:"150px",items:Z.map(e=>new sap.ui.unified.CalendarLegendItem({text:e.text,color:e.color,type:e.type}))}),ee=m.getProperty("/legendColorsEchos"),L=new P({visible:!1,standardItems:"Today",columnWidth:"180px",items:ee.map(e=>new sap.ui.unified.CalendarLegendItem({text:e.text,color:e.color,type:e.type}))}),te=m.getProperty("/legendColorsSeuils"),C=new P({visible:!1,standardItems:"Today",columnWidth:"260px",items:te.map(e=>new sap.ui.unified.CalendarLegendItem({text:e.text,color:e.color,type:e.type}))}),f=new N({id:"calendar",legend:w,firstDayOfWeek:1,width:"1200px",months:6,singleSelection:!0,showWeekNumbers:!1,select:_,specialDates:{path:"/specialDates",template:new K({startDate:"{startDate}",endDate:"{endDate}",color:"{color}",type:"{type}",customData:[new F({key:"weekLabel",value:"{weekLabel}"}),new F({key:"monthLabel",value:"{monthLabel}"}),new F({key:"trimesterLabel",value:"{trimesterLabel}"})]})}});f.attachStartDateChange(function(e){const s=e.getParameter("startDate"),a=f.getMinDate();s<a&&f.setStartDate(a)});const ae=new M({text:"Date de référence :",width:"120px"}),se=new U({icon:"sap-icon://download",tooltip:"Télécharger le calendrier",visible:!0,press:function(){window.print()},text:"Télécharger"});new V({id:"cassylLogo",src:"/CassylMama.jpg",width:"100px"});const oe=new V({id:"QRBoutique",src:"/QRBoutique.png",width:"100px"}),ne=new sap.m.Link({text:"www.cassylmama.com",target:"_blank",href:"http://www.cassylmama.com"}),re=new U({icon:"sap-icon://pdf-attachment",tooltip:"Exporter le calendrier en PDF",text:"Exporter en PDF",visible:!1,press:function(){X(f)}}),W=new g({width:"100%",items:[new b({items:[ae.addStyleClass("sapUiLargeMarginBegin sapUiMediumMarginEnd"),x.addStyleClass("sapUiMediumMarginEnd"),S.addStyleClass("sapUiLargeMarginEnd"),B.addStyleClass("sapUiLargeMarginEnd"),se.addStyleClass("sapUiMediumMarginEnd"),re.addStyleClass("sapUiLargeMarginEnd")],alignItems:"Center",justifyContent:"Start"}).addStyleClass("sapUiLargeMarginBegin sapUiMediumMarginTop sapUiMediumMarginBottom"),new b({items:[D],justifyContent:"Center"}),new b({id:"calendarHbox",items:[f,w,L,C],alignItems:"Start",justifyContent:"Center",gap:"0px 80px"}),new g({id:"footerHbox",fitContainer:!0,items:[new b({fitContainer:!0,alignContent:"Center",alignItems:"Center",justifyContent:"End",items:[oe]}),new b({fitContainer:!0,alignContent:"Center",alignItems:"Center",justifyContent:"End",items:[ne]})]})]}),v=moment().subtract(5,"months"),ie=z.getInstance(v.year(),v.month(),v.date());f.displayDate(ie);const $=new T({title:"Visualisation des semaines d'aménorrhée",content:[W]});$.setShowHeader(!1),new R({pages:[$]}).placeAt("content"),W.setModel(m)})}window.onUI5Init=le;const E=document.createElement("script");E.id="sap-ui-bootstrap";E.src="https://sdk.openui5.org/resources/sap-ui-core.js";E.setAttribute("data-sap-ui-libs","sap.m");E.setAttribute("data-sap-ui-theme","sap_horizon");E.setAttribute("data-sap-ui-async","true");E.setAttribute("data-sap-ui-onInit","onUI5Init");document.head.appendChild(E);
