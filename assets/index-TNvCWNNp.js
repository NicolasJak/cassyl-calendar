(function(){const E=document.createElement("link").relList;if(E&&E.supports&&E.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))C(u);new MutationObserver(u=>{for(const D of u)if(D.type==="childList")for(const w of D.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&C(w)}).observe(document,{childList:!0,subtree:!0});function k(u){const D={};return u.integrity&&(D.integrity=u.integrity),u.referrerPolicy&&(D.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?D.credentials="include":u.crossOrigin==="anonymous"?D.credentials="omit":D.credentials="same-origin",D}function C(u){if(u.ep)return;u.ep=!0;const D=k(u);fetch(u.href,D)}})();function Z(){sap.ui.require(["sap/m/App","sap/m/Page","sap/m/Select","sap/m/Label","sap/m/DatePicker","sap/m/VBox","sap/m/HBox","sap/ui/unified/Calendar","sap/ui/unified/CalendarLegend","sap/ui/unified/CalendarLegendItem","sap/ui/unified/DateTypeRange","sap/ui/model/json/JSONModel","sap/ui/core/date/UI5Date","sap/ui/core/CustomData","sap/m/MessageToast"],function(O,E,k,C,u,D,w,R,x,ee,K,N,j,I,P){const p=new N({entryMethod:null,selectedDate:null,selectedCalendar:"Reperes",specialDates:[],legendColors:[{text:"Dernières règles",color:"#4B0082",type:"Type01"},{text:"1 mois",color:"#FF3B3F",type:"Type02"},{text:"2 mois",color:"#FF9A00",type:"Type03"},{text:"3 mois",color:"#FFDA00",type:"Type04"},{text:"4 mois",color:"#6A0DAD",type:"Type05"},{text:"5 mois",color:"#FF69B4",type:"Type06"},{text:"6 mois",color:"#00FA9A",type:"Type07"},{text:"7 mois",color:"#111000",type:"Type08"},{text:"8 mois",color:"#00BFFF",type:"Type09"},{text:"9 mois",color:"#FFD700",type:"Type10"},{text:"DPA",color:"#2F4F4F",type:"Type20"}],legendColorsEchos:[{text:"Echo T1 datation",color:"#00FA9A",type:"Type11"},{text:"Echo T2 morphologie",color:"#00BFFF",type:"Type12"},{text:"Echo T3 croissance",color:"#FF69B4",type:"Type13"}],legendColorsSeuils:[{text:"Dépistage du diabète gestationnel",color:"#FF9A00",type:"Type14"},{text:"Grande prématurité",color:"#6A0DAD",type:"Type15"},{text:"Prématurité modérée",color:"#111000",type:"Type16"},{text:"Prématurité tardive",color:"#00BFFF",type:"Type17"},{text:"A terme",color:"#00FA9A",type:"Type18"}]});function A(e){if(!e)return;const s=p.getProperty("/entryMethod"),a=[],o=p.getProperty("/legendColors")||[];let i,n=null,t="#E0E0E0";switch(s){case"regles":i=moment(e,"YYYY-MM-DD").toDate(),a.push({startDate:i,endDate:i,color:"#4B0082",type:"Type01",weekLabel:"Date des dernières règles"});break;case"conception":i=moment(e,"YYYY-MM-DD").subtract(14,"days").toDate(),a.push({startDate:moment(e,"YYYY-MM-DD").toDate(),endDate:moment(e,"YYYY-MM-DD").toDate(),color:"#4B0082",type:"Type01",weekLabel:"Date de conception estimée"});break;case"dpa":i=moment(e,"YYYY-MM-DD").subtract(280,"days").toDate(),a.push({startDate:moment(e,"YYYY-MM-DD").subtract(266,"days").toDate(),endDate:moment(e,"YYYY-MM-DD").subtract(266,"days").toDate(),color:"#4B0082",type:"Type01",weekLabel:"Date de conception estimée"});break;default:i=moment(e,"YYYY-MM-DD").toDate(),a.push({startDate:i,endDate:i,color:"#4B0082",type:"Type01",weekLabel:"Date des dernières règles"})}a.push({startDate:moment(i).add(280,"days").toDate(),endDate:moment(i).add(280,"days").toDate(),color:"#2F4F4F",type:"Type20",weekLabel:"Date prévue d'accouchement (DPA)"});let m=0,y=1;for(let h=0;h<41;h++){const d=h,r=moment(i).add(d,"weeks");if(d<2){n="Type12";const l=o.find(c=>c.type===n);t=l?l.color:"#E0E0E0",a.push({startDate:r.toDate(),endDate:moment(r).add(6,"days").toDate(),color:t,type:n,weekLabel:`${d} SA`,monthLabel:"Mois "+m,trimesterLabel:"Trimestre "+y})}else if(d>1&&d<5){m=1,n="Type02";const l=o.find(c=>c.type===n);t=l?l.color:"#E0E0E0",a.push({startDate:r.toDate(),endDate:moment(r).add(6,"days").toDate(),color:t,type:n,weekLabel:`${d} SA`,monthLabel:"Mois "+m,trimesterLabel:"Trimestre "+y})}else if(d>4&&d<9){m=2,n="Type03";const l=o.find(c=>c.type===n);t=l?l.color:"#E0E0E0",a.push({startDate:r.toDate(),endDate:moment(r).add(6,"days").toDate(),color:t,type:n,weekLabel:`${d} SA`,monthLabel:"Mois "+m,trimesterLabel:"Trimestre "+y})}else if(d>8&&d<14){m=3,n="Type04";const l=o.find(c=>c.type===n);t=l?l.color:"#E0E0E0",a.push({startDate:r.toDate(),endDate:moment(r).add(6,"days").toDate(),color:t,type:n,weekLabel:`${d} SA`,monthLabel:"Mois "+m,trimesterLabel:"Trimestre "+y})}else if(d>13&&d<19){m=4,y=2,n="Type05";const l=o.find(c=>c.type===n);t=l?l.color:"#E0E0E0",a.push({startDate:r.toDate(),endDate:moment(r).add(6,"days").toDate(),color:t,type:n,weekLabel:`${d} SA`,monthLabel:"Mois "+m,trimesterLabel:"Trimestre "+y})}else if(d>18&&d<23){m=5,y=2,n="Type06";const l=o.find(c=>c.type===n);t=l?l.color:"#E0E0E0",a.push({startDate:r.toDate(),endDate:moment(r).add(6,"days").toDate(),color:t,type:n,weekLabel:`${d} SA`,monthLabel:"Mois "+m,trimesterLabel:"Trimestre "+y})}else if(d>22&&d<28){m=6,y=2,n="Type07";const l=o.find(c=>c.type===n);t=l?l.color:"#E0E0E0",a.push({startDate:r.toDate(),endDate:moment(r).add(6,"days").toDate(),color:t,type:n,weekLabel:`${d} SA`,monthLabel:"Mois "+m,trimesterLabel:"Trimestre "+y})}else if(d>27&&d<32){m=7,y=3,n="Type08";const l=o.find(c=>c.type===n);t=l?l.color:"#E0E0E0",a.push({startDate:r.toDate(),endDate:moment(r).add(6,"days").toDate(),color:t,type:n,weekLabel:`${d} SA`,monthLabel:"Mois "+m,trimesterLabel:"Trimestre "+y})}else if(d>31&&d<36){m=8,y=3,n="Type09";const l=o.find(c=>c.type===n);t=l?l.color:"#E0E0E0",a.push({startDate:r.toDate(),endDate:moment(r).add(6,"days").toDate(),color:t,type:n,weekLabel:`${d} SA`,monthLabel:"Mois "+m,trimesterLabel:"Trimestre "+y})}else if(d>35&&d<40){m=9,y=3,n="Type10";const l=o.find(c=>c.type===n);t=l?l.color:"#E0E0E0",a.push({startDate:r.toDate(),endDate:moment(r).add(6,"days").toDate(),color:t,type:n,weekLabel:`${d} SA`,monthLabel:"Mois "+m,trimesterLabel:"Trimestre "+y})}}p.setProperty("/specialDates",a),f.setMinDate(i),f.setInitialFocusedDate(i),F.getItems().forEach(h=>{h.getKey()!=="Reperes"&&h.setEnabled(!0)})}function W(e){let s,a,o,i;if(e.length>0){const t=e[0];t.weekLabel==="Date des dernières règles"?s=moment(t.startDate):t.weekLabel==="Date de conception estimée"&&(s=moment(t.startDate).subtract(14,"days"))}e=e.filter(t=>t.type==="Type01"||t.type==="Type20"),p.setProperty("/specialDates",e);const n=p.getProperty("/legendColorsEchos")||[];o="Type11",a=n.find(t=>t.type===o),i=a?a.color:"#E0E0E0",e.push({startDate:moment(s).add(77,"days").toDate(),endDate:moment(s).add(97,"days").toDate(),color:i,type:o,weekLabel:"Echos T1 datation"}),o="Type12",a=n.find(t=>t.type===o),i=a?a.color:"#E0E0E0",e.push({startDate:moment(s).add(140,"days").toDate(),endDate:moment(s).add(175,"days").toDate(),color:i,type:o,weekLabel:"Echos T2 morphologie"}),o="Type13",a=n.find(t=>t.type===o),i=a?a.color:"#E0E0E0",e.push({startDate:moment(s).add(210,"days").toDate(),endDate:moment(s).add(245,"days").toDate(),color:i,type:o,weekLabel:"Echos T3 croissance"}),p.setProperty("/specialDates",e)}function z(e){let s,a,o,i;if(e.length>0){const t=e[0];t.weekLabel==="Date des dernières règles"?s=moment(t.startDate):t.weekLabel==="Date de conception estimée"&&(s=moment(t.startDate).subtract(14,"days"))}e=e.filter(t=>t.type==="Type01"||t.type==="Type20"),p.setProperty("/specialDates",e);const n=p.getProperty("/legendColorsSeuils")||[];o="Type14",a=n.find(t=>t.type===o),i=a?a.color:"#E0E0E0",e.push({startDate:moment(s).add(168,"days").toDate(),endDate:moment(s).add(196,"days").toDate(),color:i,type:o,weekLabel:"Dépistage du diabète gestationnel"}),o="Type15",a=n.find(t=>t.type===o),i=a?a.color:"#E0E0E0",e.push({startDate:moment(s).add(196,"days").toDate(),endDate:moment(s).add(223,"days").toDate(),color:i,type:o,weekLabel:"Grande prématurité"}),o="Type16",a=n.find(t=>t.type===o),i=a?a.color:"#E0E0E0",e.push({startDate:moment(s).add(224,"days").toDate(),endDate:moment(s).add(244,"days").toDate(),color:i,type:o,weekLabel:"Prématurité modérée"}),o="Type17",a=n.find(t=>t.type===o),i=a?a.color:"#E0E0E0",e.push({startDate:moment(s).add(245,"days").toDate(),endDate:moment(s).add(258,"days").toDate(),color:i,type:o,weekLabel:"Prématurité tardive"}),o="Type18",a=n.find(t=>t.type===o),i=a?a.color:"#E0E0E0",e.push({startDate:moment(s).add(259,"days").toDate(),endDate:moment(s).add(280,"days").toDate(),color:i,type:o,weekLabel:"A terme"}),p.setProperty("/specialDates",e)}function q(){const e=f.getSelectedDates()[0].getStartDate(),s=moment(e).startOf("day"),a=p.getProperty("/selectedCalendar"),o=f.getSpecialDates();let i="Aucune légende",n="",t="",m=0;const y=p.getProperty("/entryMethod"),h=o.find(r=>moment(r.mProperties.startDate).isSame(s,"day")&&r.mProperties.type==="Type01"),d=o.find(r=>moment(r.mProperties.startDate).isSame(s,"day")&&r.mProperties.type==="Type20");if(h){let r="";switch(y){case"regles":r="Date des dernières règles";break;case"conception":r="Date estimée de conception";break;case"dpa":r="Date estimée de conception";break;default:r="Date des dernières règles"}P.show(r,{duration:5e3,width:"100%",my:"CenterBottom",at:"CenterCenter",of:window,offset:"0 0",collision:"fit fit",onClose:null,autoClose:!0,animationTimingFunction:"ease",animationDuration:1e3,closeOnBrowserNavigation:!0});return}if(d){P.show("Date prévue d'accouchement (DPA)",{duration:5e3,width:"100%",my:"CenterBottom",at:"CenterCenter",of:window,offset:"0 0",collision:"fit fit",onClose:null,autoClose:!0,animationTimingFunction:"ease",animationDuration:1e3,closeOnBrowserNavigation:!0});return}for(let r=0;r<o.length;r++){const l=moment(o[r].mProperties.startDate).startOf("day"),c=o[r].mProperties.endDate?moment(o[r].mProperties.endDate).startOf("day"):l;if(s.isSameOrAfter(l)&&s.isSameOrBefore(c)){o[r].mProperties.type,o[r].getCustomData().forEach($=>{const B=$.getKey(),v=$.getValue();B==="weekLabel"?i=v:B==="monthLabel"?n=v:B==="trimesterLabel"&&(t=v)}),m=s.diff(l,"days");break}}if(i&&i!=="Aucune légende"){m>0&&a==="Reperes"&&(i+=` + ${m}`);const r=[i,n!=="0 mois de grosssesse"?n:null,t].filter(Boolean).join(`
`);P.show(r,{duration:5e3,width:"100%",my:"CenterBottom",at:"CenterCenter",of:window,offset:"0 0",collision:"fit fit",onClose:null,autoClose:!0,animationTimingFunction:"ease",animationDuration:1e3,closeOnBrowserNavigation:!0})}}function G(e){const s=p.getProperty("/specialDates");if(e==="Reperes")f.setLegend(g),g.setVisible(!0),L.setVisible(!1),T.setVisible(!1),S.setEnabled(!0),M.setEnabled(!0),A(p.getProperty("/selectedDate"));else if(e==="Echos"){if(s.length===0)return;f.setLegend(L),L.setVisible(!0),g.setVisible(!1),T.setVisible(!1),S.setEnabled(!1),M.setEnabled(!1),W(s)}else if(e==="Seuils"){if(s.length===0)return;f.setLegend(T),T.setVisible(!0),g.setVisible(!1),L.setVisible(!1),S.setEnabled(!1),M.setEnabled(!1),z(s)}}const S=new k({width:"250px",selectedKey:null,change:function(e){const s=e.getParameter("selectedItem").getKey();p.setProperty("/entryMethod",s);var a=p.getProperty("/selectedDate");a&&A(a);const o=s==="regles"?"Dernières règles":"Conception estimée",i=g.getItems();i.length>0&&i[0].setText(o)},items:[new sap.ui.core.Item({key:"regles",text:"Dernières règles"}),new sap.ui.core.Item({key:"conception",text:"Conception estimée"}),new sap.ui.core.Item({key:"dpa",text:"DPA"})]}),M=new u({width:"200px",placeholder:"Sélectionnez une date",value:"{/selectedDate}",displayFormat:"dd/MM/yyyy",valueFormat:"yyyy-MM-dd",change:function(e){const s=e.getSource().getValue();p.setProperty("/selectedDate",s),A(s),g.setVisible(!0)}}),F=new sap.m.SegmentedButton({selectedKey:"Reperes",width:"300px",items:[new sap.m.SegmentedButtonItem({key:"Reperes",text:"Calendrier",tooltip:"Calendrier des semaines d'aménorrhée"}),new sap.m.SegmentedButtonItem({key:"Echos",text:"Echos",tooltip:"Retrouvez les grandes étapes d'imagerie de la grossesse",enabled:!1}),new sap.m.SegmentedButtonItem({key:"Seuils",text:"Seuils",tooltip:"Suivez les périodes sensibles de la grossesse",enabled:!1})],selectionChange:function(e){const s=e.getParameter("item").getKey();p.setProperty("/selectedCalendar",s);var a=p.getProperty("/selectedCalendar");a&&G(a)}});F.addStyleClass("CassylSegmentedButton"),new sap.m.Switch({state:!1,customTextOn:"RDV",customTextOff:"SA",enabled:!1,change:function(e){}});const H=p.getProperty("/legendColors"),g=new x({visible:!1,standardItems:"Today",columnWidth:"150px",items:H.map(e=>new sap.ui.unified.CalendarLegendItem({text:e.text,color:e.color,type:e.type}))}),J=p.getProperty("/legendColorsEchos"),L=new x({visible:!1,standardItems:"Today",columnWidth:"180px",items:J.map(e=>new sap.ui.unified.CalendarLegendItem({text:e.text,color:e.color,type:e.type}))}),_=p.getProperty("/legendColorsSeuils"),T=new x({visible:!1,standardItems:"Today",columnWidth:"260px",items:_.map(e=>new sap.ui.unified.CalendarLegendItem({text:e.text,color:e.color,type:e.type}))}),f=new R({id:"calendar",legend:g,firstDayOfWeek:1,width:"1200px",months:6,singleSelection:!0,showWeekNumbers:!1,select:q,specialDates:{path:"/specialDates",template:new K({startDate:"{startDate}",endDate:"{endDate}",color:"{color}",type:"{type}",customData:[new I({key:"weekLabel",value:"{weekLabel}"}),new I({key:"monthLabel",value:"{monthLabel}"}),new I({key:"trimesterLabel",value:"{trimesterLabel}"})]})}});f.attachStartDateChange(function(e){const s=e.getParameter("startDate"),a=f.getMinDate();s<a&&f.setStartDate(a)});const Q=new C({text:"Date de référence :",width:"120px"}),V=new D({width:"100%",items:[new w({items:[Q.addStyleClass("sapUiLargeMarginBegin sapUiMediumMarginEnd"),S.addStyleClass("sapUiMediumMarginEnd"),M.addStyleClass("sapUiLargeMarginEnd"),F.addStyleClass("sapUiLargeMarginEnd")],alignItems:"Center",justifyContent:"Start"}).addStyleClass("sapUiLargeMarginBegin sapUiMediumMarginTop sapUiMediumMarginBottom"),new w({items:[f,g,L,T],alignItems:"Start",justifyContent:"Center",gap:"0px 80px"})]}),Y=moment().subtract(5,"months"),X=j.getInstance(Y.year(),Y.month(),Y.date());f.displayDate(X);const U=new E({title:"Visualisation des semaines d'aménorrhée",content:[V]});U.setShowHeader(!1),new O({pages:[U]}).placeAt("content"),V.setModel(p)})}window.onUI5Init=Z;const b=document.createElement("script");b.id="sap-ui-bootstrap";b.src="https://sdk.openui5.org/resources/sap-ui-core.js";b.setAttribute("data-sap-ui-libs","sap.m");b.setAttribute("data-sap-ui-theme","sap_horizon");b.setAttribute("data-sap-ui-async","true");b.setAttribute("data-sap-ui-onInit","onUI5Init");document.head.appendChild(b);
